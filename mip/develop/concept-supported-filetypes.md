---
title: 支持的文件类型-Microsoft 信息保护 SDK
description: 有关受支持的文件类型、文件扩展名以及负责 Microsoft 信息保护软件开发工具包的管理员的保护级别的技术详细信息。
author: msmbaldwin
ms.author: mbaldwin
ms.date: 08/16/2020
ms.topic: conceptual
ms.service: information-protection
ms.openlocfilehash: e247a31b364c40f270538d73815464491fca7647
ms.sourcegitcommit: 8e48016754e6bc6d051138b3e3e3e3edbff56ba5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/04/2021
ms.locfileid: "97864849"
---
# <a name="file-types-supported-by-the-microsoft-information-protection-sdk"></a>Microsoft 信息保护 SDK 支持的文件类型

Microsoft 信息保护 SDK 可将以下内容应用于文档和电子邮件：

- 仅分类

- 分类和保护

- 仅保护

Microsoft 信息保护 SDK 还可以使用已知的敏感信息类型或你定义的正则表达式来检查某些文件类型的内容。

使用以下信息检查 Microsoft 信息保护 SDK 支持的文件类型，了解不同级别的保护，以及如何更改默认保护级别，以及确定哪些文件被自动排除 (从分类和保护中跳过) 。

## <a name="file-types-supported-for-classification-only"></a>支持仅分类的文件类型

可对以下文件类型进行分类（即使在它们未受保护时也可）。

- **Adobe 可移植文档格式**：pdf

- **Microsoft Project**：.mpp、.mpt

- **Microsoft Publisher**：.pub

- **Microsoft XPS**：.xps .oxps

- 图像：.jpg、.jpe、.jpeg、.jif、.jfif、.jfi、 .png、.tif、.tiff

- **Autodesk Design Review 2013**：.dwfx

- **Adobe Photoshop**：.psd

- **数码底片**：.dng

- **Microsoft Office**：下表中的文件类型。

    这些文件类型的受支持文件格式是以下 Office 程序的 97-2003 文件格式和 Office Open XML 格式：Word、Excel 和 PowerPoint。

    | Office 文件类型                                                                                                                                                                                                                                               | Office 文件类型                                                                                                                                                                                                                                 |
    | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
    | .doc<br /><br />.docm<br /><br />.docx<br /><br />.dot<br /><br />.dotm<br /><br />.dotx<br /><br />.potm<br /><br />.potx<br /><br />.pps<br /><br />.ppsm<br /><br />.ppsx<br /><br />.ppt<br /><br />.pptm<br /><br />.pptx<br /><br />.vdw<br /><br />.vsd | .vsdm<br /><br /> .vsdx<br /><br />.vss<br /><br />.vssm<br /><br />.vst<br /><br />.vstm<br /><br />.vssx<br /><br />.vstx<br /><br />.xls<br /><br />.xlsb<br /><br />.xlt<br /><br />.xlsm<br /><br />.xlsx<br /><br />.xltm<br /><br />.xltx |

其他文件类型在受保护时也支持分类。 有关这些文件类型，请参阅[支持分类和保护的文件类型](#supported-file-types-for-classification-and-protection)部分。

例如，如果标签为 " **常规**"、"应用分类并且不应用保护"，则可以将 " **常规** " 标签应用到名为 sales.pdf 的文件，但不能将此标签应用于名为 sales.txt 的文件。

此外，如果标签 " **机密 \ 所有员工** " 应用分类和保护，则可以将此标签应用到名为 sales.pdf 的文件和名为 sales.txt 的文件。 还可以只对这些文件应用保护，而不应用分类。

## <a name="file-types-supported-for-protection"></a>支持保护的文件类型

Microsoft 信息保护 SDK 支持两个不同级别的保护，如下表中所述。

| 保护类型     | 本机                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 泛型                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 说明            | 对于文本、图像、Microsoft Office（Word、Excel、PowerPoint）文件、pdf 文件和其他支持 Rights Management 服务的应用程序文件类型，本机保护提供了同时包括权限的加密和强制执行的强保护级别。                                                                                                                                                                                                                                                                                       | 对于其他所有应用程序和文件类型，常规保护提供了一种保护级别，该保护级别既包括使用 .pfile 文件类型的文件封装，又包括用于验证用户是否有权打开该文件的身份验证。                                                                                                                                                                                                                                                                                              |
| 保护             | 通过以下方式强制执行文件保护：<br /><br />- 必须在通过电子邮件接收文件的用户或通过文件被授予访问权限或共享权限的用户成功通过身份验证之后，才能呈现受保护的内容。<br /><br />- 此外，无论是使用 Azure 信息保护查看器（适用于受保护的文本和图像文件）还是使用关联的应用程序（适用于其他所有受支持的文件类型）呈现内容时，都会强制执行内容所有者在文件处于受保护状态时所设置的使用权限和策略。 | 通过以下方式强制执行文件保护：<br /><br />- 必须在经授权可打开文件的人员以及被授予访问权限的人员成功通过身份验证之后才能呈现受保护的内容。 如果授权失败，则文件不会打开。<br /><br />- 将显示由内容所有者设置的使用权限和策略，以向授权用户通知预期使用策略。<br /><br />- 将对已授权的用户打开和访问文件的操作执行审核日志记录。 但不强制执行使用权限。 |
| 文件类型默认值 | 这是以下文件类型的默认保护级别：<br /><br />- 文本和图像文件<br /><br />- Microsoft Office（Word、Excel、PowerPoint）文件<br /><br />- 可移植文档格式 (.pdf)<br /><br />有关详细信息，请参阅以下部分：[支持分类和保护的文件类型](#supported-file-types-for-classification-and-protection)。                                                                                                                                                                              | 这是针对不受本机保护支持的其他所有文件类型（例如 .vsdx、.rtf 等）的默认保护。                                                                                                                                                                                                                                                                                                                                                                                             |

你可以更改 Microsoft 信息保护 SDK 应用的默认保护级别。 你可以将本机的默认级别更改为常规，从泛型更改为本机，甚至可以阻止 Microsoft 信息保护 SDK 应用保护。

### <a name="file-sizes-supported-for-protection"></a>支持保护的文件大小

从 Microsoft 信息保护 SDK 1.6 开始，最大默认文件大小为 6 GB。 如果需要，可以重写此设置。 旧版 Office 平台的默认值仍适用。


- **Office 文件：**

  | Office 应用程序                                                                                                          | 支持的最大文件大小                                                                                                |
  | --------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
  | Word 2007（仅受 AD RMS 支持）<br /><br />Word 2010<br /><br />Word 2013<br /><br />Word 2016                         | 32 位：512 MB<br /><br />64 位：512 MB                                                                                   |
  | Excel 2007（仅受 AD RMS 支持）<br /><br />Excel 2010<br /><br />Excel 2013<br /><br />Excel 2016                     | 32 位：2 GB<br /><br />64 位：仅受可用磁盘空间和内存限制                                            |
  | PowerPoint 2007（仅受 AD RMS 支持）<br /><br />PowerPoint 2010<br /><br />PowerPoint 2013<br /><br />PowerPoint 2016 | 32 位：仅受可用磁盘空间和内存限制<br /><br />64 位：仅受可用磁盘空间和内存限制 |

- **对于其他所有文件**：

    若要保护其他文件类型，并使用 SDK 删除对这些文件类型的保护：最大文件大小仅受可用磁盘空间和内存限制。

### <a name="supported-file-types-for-classification-and-protection"></a>支持用于分类和保护的文件类型

下表列出了支持 Microsoft 信息保护 SDK 的本机保护的文件类型的子集，还可以进行分类。

这些文件类型单独进行标识，因为它们受到本机保护时，原始文件扩展名将更改，这些文件将变为只读。 请注意，以常规形式保护文件时，原始文件扩展名将始终更改为 .pfile。

> [!WARNING]
> 如果拥有可根据文件扩展名进行检查并采取操作的防火墙、Web 代理或者安全软件，你可能需要重新配置这些网络设备和软件以支持这些新的文件扩展名。

| 原始文件扩展名 | 受保护的文件扩展名 |
| ---------------------------- | ----------------------------- |
| .txt                         | .ptxt                         |
| .xml                         | .pxml                         |
| .jpg                         | .pjpg                         |
| .jpeg                        | .pjpeg                        |
| .pdf                         | .ppdf [[1]](#footnote-1)      |
| .png                         | .ppng                         |
| .tif                         | .ptif                         |
| .tiff                        | .ptiff                        |
| .bmp                         | .pbmp                         |
| .gif                         | .pgif                         |
| .jpe                         | .pjpe                         |
| .jfif                        | .pjfif                        |

###### <a name="footnote-1"></a>脚注 1
对于最新版本的 Microsoft 信息保护 SDK，受保护的 PDF 文档的文件扩展名将保留为 .pdf。

下表列出了 Microsoft 信息保护 SDK 支持本机保护的其他文件类型，也可以进行分类。 会将它们识别为用于 Microsoft Office 应用的文件类型。 这些文件类型的受支持文件格式是以下 Office 程序的 97-2003 文件格式和 Office Open XML 格式：Word、Excel 和 PowerPoint。

对于这些文件，在文件受 Rights Management 服务保护后，文件扩展名仍保持不变。

| Office 支持的文件类型                                                                                                                                                                                                                  | Office 支持的文件类型                                                                                                                                                                                                                  |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| .doc<br /><br />.docm<br /><br />.docx<br /><br />.dot<br /><br />.dotm<br /><br />.dotx<br /><br />.potm<br /><br />.potx<br /><br />.pps<br /><br />.ppsm<br /><br />.ppsx<br /><br />.ppt<br /><br />.pptm<br /><br />.pptx<br /><br />.vsdm | .vsdx<br /><br />.vssm<br /><br />.vssx<br /><br />.vstm<br /><br />.vstx<br /><br />.xla<br /><br />.xlam<br /><br />.xls<br /><br />.xlsb<br /><br />.xlt<br /><br />.xlsm<br /><br />.xlsx<br /><br />.xltm<br /><br />.xltx<br /><br />.xps |

### <a name="limitations-for-container-files-such-as-zip-msg-files"></a>容器文件的限制，例如 .zip、.msg 文件

容器文件是包括其他文件的文件，典型示例是包括压缩文件的 .zip 文件。 其他示例包括： rar、7z、.msg 文件、.rpmsg 文件和包含附件的 PDF 文档。

可对这些容器文件进行分类和保护，但分类和保护不会应用到容器内每个文件。 同样，可以使用 SDK 对受保护的容器文件解除保护，但如果对容器中的文件应用) ，则不会以递归方式对容器文件上的文件进行保护删除 (。 应用程序开发人员负责递归和取消保护容器中的任何文件。

如果容器文件包括已分类和受保护的文件，必须先提取这些文件，以更改其分类或保护设置。
